# Retail Store Data Integration Project: Snowflake, Python, SQL & Power BI

### Dashboard Link: 
https://app.powerbi.com/groups/me/reports/4c5a1abb-cf01-4821-aed4-33b80d93b8dd/2e73bcb83340ba56a54d?experience=power-bi&bookmarkGuid=e98dc020d34091e47b80

## üìå Overview
This project simulates a real-world scenario of building a modern data warehouse and business intelligence (DWBI) solution for a retail company. Using tools like Python, Snowflake, SQL, and Power BI, we follow the journey from raw data to impactful executive dashboards. The goal is to demonstrate how a complete analytics solution can be built i.e. from data modeling to insight generation, using cloud and open-source tools.

---

## üß© Problem Statement
An offline retail company with 100+ stores and thousands of SKUs wants to analyze 10+ years of sales and customer activity. The goal is to generate executive-level insights from their transaction data and loyalty program participation.

---

## üõ†Ô∏è Tools & Technologies Used
- **Python**: For generating synthetic data using libraries like `Faker`, `Random`, and `Pandas`
- **Snowflake**: To act as the centralized cloud-based data warehouse
- **SQL (Snowflake dialect)**: For data transformation and ad hoc analysis
- **Power BI**: For reporting and dashboard creation

---


## üîÑ Step-by-Step Workflow

### 1. üìê Data Modeling ‚Äì ER Diagram
I started by identifying key entities: Customers, Stores, Products, Orders, and Loyalty Programs. From this, I created a **Snowflake Schema**:

- **Dimension Tables**:
  - `dim_customer`: ID, Name, Gender, DOB, Email, Address, Loyalty Program ID
  - `dim_store`: ID, Store Name, Type, Region, Manager, Opening Date
  - `dim_product`: ID, Product Name, Brand, Category, Unit Price
  - `dim_loyalty_program`: ID, Tier, Program Name, Points Required
  - `dim_date`: Date ID, Date, Month, Quarter, Year
- **Fact Table**:
  - `fact_orders`: Order ID, Foreign Keys to dimensions, Quantity, Order Amount, Discount, Shipping, Total Amount

This design ensures normalized storage with efficient querying for analytics.


![image](https://github.com/user-attachments/assets/cd657b80-a6ef-4e1b-99c0-4832bfd669ef)


---

### 2. üêç Data Generation with Python
I used Python scripts to simulate real-world data for all dimension tables and the fact table.

- **Faker** library was used for generating names, emails, addresses, and dates.
- Custom logic added randomness to store types, product categories, and loyalty tiers.
- **Historical Sales Data**: 10 years of daily transactions were generated across 100+ stores.
- Over 90+ CSV files simulate daily sales to mimic real-world incremental loads.

Screenshot of the scripts of main csv files are as follows:


### DimCustomer

![image](https://github.com/user-attachments/assets/791bcd54-b96d-4d37-aef7-224ca61c6204)


### DimProduct

![image](https://github.com/user-attachments/assets/9ea9143e-d4ad-474c-8ac9-b8bc1b19a1d5)


### DimStoreData

![image](https://github.com/user-attachments/assets/92168557-dd2e-4768-8111-a53c93712de6)


### HistoricalSalesData

![image](https://github.com/user-attachments/assets/41d99f1f-79c0-4f50-86e6-519d83411a0b)



---

### 3. ‚ùÑÔ∏è Loading Data into Snowflake
On Snowflake account, I created the warehouse, database, schema, and the tables using following commands:

![image](https://github.com/user-attachments/assets/bb800166-236f-4ee6-b2cf-3fa082496bc3)
![image](https://github.com/user-attachments/assets/b277ceb6-8bfb-471d-9495-515166224881)




- Used **SnowSQL** and `COPY INTO` commands to load CSVs into staging tables
- Data was then inserted into fact/dimension tables with constraints and integrity checks
- Verified successful loading with SQL row counts and joins

![image](https://github.com/user-attachments/assets/d3c617b7-0943-4c1e-84d6-d7e39d005bfc)

---

### 4. üß† SQL-Based Data Analysis in Snowflake
Using SQL, I ran **ad hoc queries** to explore the data and find insights. Some examples include:

- Revenue by Region, Loyalty Tier, or Store Type

![image](https://github.com/user-attachments/assets/233f548b-6499-441a-a6e4-a1c080b02677)

- Customers who havent placed order in the last 5 months

![image](https://github.com/user-attachments/assets/14bf4329-01a9-4687-b043-588536a5fed2)

- Most recent store along with its sales

![image](https://github.com/user-attachments/assets/ad576b3c-af6a-407f-811d-4f09e3ea6a0b)

- Finding highest discount given on any order in last 1 year

![image](https://github.com/user-attachments/assets/735c2b48-1564-44d9-ba80-62e9232e6036)

- Top 3 brands based on their sales in last year

![image](https://github.com/user-attachments/assets/1c175bf2-294f-47d7-ba69-889b8d631577)
  
- Revenue generated by each store manager in June 2024

![image](https://github.com/user-attachments/assets/c1080b0e-7508-47b6-85a9-71051595714f)



---


## üìä Power BI Dashboard ‚Äì ‚ÄúRetail Store Overview‚Äù

### 5. üîß Data Modeling and Cleaning in Power BI
- Connected Power BI to Snowflake via DirectQuery
- Created relationships between fact and dimension tables

![image](https://github.com/user-attachments/assets/1e5e8a66-d8e4-44e1-8d1a-d5ac27792db6)


- Used **Power Query Editor** to:
  - Filter null or incorrect values
  - Format columns (dates, currency, categories)
  - Rename and organize fields for better reporting

![image](https://github.com/user-attachments/assets/638264b4-710c-448c-87e6-47786fc9726f)


### 6. Calculated Columns and DAX Measures Created
Key metrics developed include:

Age calculated by subtracted Dob with current date, and Age Distribution calculated column created after that

![image](https://github.com/user-attachments/assets/a470fd86-63b1-4705-935f-389a93714cae)


```DAX
Total Order Amount = SUM(fact_orders[Order_Amount])
Total Discount = SUM(fact_orders[Discount_Amount])
Total Shipping Cost = SUM(fact_orders[Shipping_Cost])
Total Orders = COUNT(fact_orders[Order_ID])
Average Order Value = [Total Order Amount] / [Total Orders]
```

![image](https://github.com/user-attachments/assets/cf7dca5d-0cc9-4630-9451-60dc82f3483f)


These KPIs enabled deep exploration of business performance.

---

### 7. üìà Visuals Created in Power BI

**KPI Cards**

**Charts and Visuals**:
- Line Chart: Orders by Year and Region
- Bar Chart: Orders by Loyalty Tier
- Bar Chart: Customer Age Segments
- Pie Chart: Orders by Business Type (SMB, Outlet, etc.)
- Table: Top 10 Countries by Order Value, Discount, and Shipping Cost

![image](https://github.com/user-attachments/assets/08ee9b3b-19d6-4292-96e6-01633a3a2759)


---

## üí° Business Insights Extracted
- **Korea** is the top-performing country in both order volume and revenue
- **Diamond loyalty members** drive the most orders
- **SMBs** contribute to over 34% of total business
- **Customers aged 35‚Äì44** and **25‚Äì35** are most active
- **Shipping costs** vary significantly by region and category

---

## ‚úÖ Conclusion
This project demonstrates how modern data stack tools (Snowflake + Power BI + Python) can be integrated to build an enterprise-grade analytics platform from scratch. It mimics real-world practices like data warehousing, star schema design, ETL scripting, ad hoc querying, and executive dashboarding.

